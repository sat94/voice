
<!DOCTYPE html>
<html>
<head>
    <title>Coach S√©duction IA</title>
</head>
<body>
    <h1>üé§ Coach S√©duction IA avec Voix</h1>
    
    <!-- S√©lecteur de voix -->
    <label for="voiceSelect">Choisir la voix du coach:</label>
    <select id="voiceSelect">
        <option value="Microsoft Server Speech Text to Speech Voice (fr-FR, DeniseNeural)">
            Sophie (Denise) - Voix f√©minine douce
        </option>
        <option value="Microsoft Server Speech Text to Speech Voice (fr-FR, BrigitteNeural)">
            Coach Brigitte - Voix f√©minine mature
        </option>
        <option value="Microsoft Server Speech Text to Speech Voice (fr-FR, HenriNeural)">
            Coach Henri - Voix masculine
        </option>
    </select>
    
    <!-- Zone de chat -->
    <div id="chat">
        <div id="messages"></div>
        <input type="text" id="userInput" placeholder="Posez votre question...">
        <button onclick="envoyerQuestion()">Envoyer</button>
    </div>
    
    <script>
        async function envoyerQuestion() {
            const input = document.getElementById('userInput');
            const voix = document.getElementById('voiceSelect').value;
            const question = input.value.trim();
            
            if (!question) return;
            
            // Afficher la question de l'utilisateur
            ajouterMessage('Vous', question, 'user');
            input.value = '';
            
            try {
                // Appel √† l'API IA
                const response = await fetch('https://aaaazealmmmma.duckdns.org/ia', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: question,
                        system_prompt: "Tu es Sophie, coach de s√©duction experte. R√©ponds en 2-3 phrases maximum.",
                        voice: voix,
                        rate: "+0%",
                        pitch: "+0Hz"
                    })
                });
                
                const result = await response.json();
                
                // Afficher la r√©ponse
                ajouterMessage('Coach IA', result.response, 'ai');
                
                // Jouer l'audio de la r√©ponse
                if (result.response_audio) {
                    jouerAudio(result.response_audio);
                }
                
            } catch (error) {
                console.error('Erreur:', error);
                ajouterMessage('Erreur', 'D√©sol√©, une erreur est survenue.', 'error');
            }
        }
        
        function ajouterMessage(auteur, texte, type) {
            const messages = document.getElementById('messages');
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.innerHTML = `<strong>${auteur}:</strong> ${texte}`;
            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
        }
        
        function jouerAudio(audioBase64) {
            const audioBlob = base64ToBlob(audioBase64, 'audio/mpeg');
            const audio = new Audio(URL.createObjectURL(audioBlob));
            audio.play();
        }
        
        function base64ToBlob(base64, mimeType) {
            const byteCharacters = atob(base64);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            const byteArray = new Uint8Array(byteNumbers);
            return new Blob([byteArray], {type: mimeType});
        }
        
        // Envoyer avec Entr√©e
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                envoyerQuestion();
            }
        });
    </script>
    
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        #chat { border: 1px solid #ccc; height: 400px; display: flex; flex-direction: column; }
        #messages { flex: 1; overflow-y: auto; padding: 10px; }
        .message { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .message.user { background: #e3f2fd; text-align: right; }
        .message.ai { background: #f3e5f5; }
        .message.error { background: #ffebee; color: red; }
        #userInput { padding: 10px; border: none; border-top: 1px solid #ccc; }
        button { padding: 10px 20px; background: #2196f3; color: white; border: none; cursor: pointer; }
        select { margin: 10px 0; padding: 5px; }
    </style>
</body>
</html>
